.. index::
   single: CONFIG

.. _config:

*****************************************************************************
 CONFIG
*****************************************************************************

MapServer has its own global configuration file. This was introduced in MapServer 8.0, and is described in
:ref:`RFC 135 <rfc135>`. The configuration file can be set using the environment variable ``MAPSERVER_CONFIG_FILE``. 
A default location can also be set when MapServer is compiled for different distributions.

The configuration file is loaded by the by the MapServer CGI at runtime and provides site-level configuration
for all Mapfiles. The configuration file has 3 sections detailed below.

.. index::
   pair: CONFIG; ENV
   :name: mapfile-config-env

ENV
    This block allows for environment variables to be stored as name value pairs - see
    :ref:`Environment Variables<environment_variables>` page for all available options.
    Prior to the introduction of the configuration file support of environment variables varied
    between different platforms. 

    .. code-block:: mapfile

      ENV
        MS_MAP_PATTERN "^/opt/mapserver" ## required
      END

.. index::
   pair: CONFIG; MAPS
   :name: mapfile-config-maps

MAPS
    This block allows for keys values to be mapped to Mapfile paths. If the ``MS_MAP_NO_PATH`` environment
    variable is set then **only** these keys can be used in the ``map=`` CGI parameter.
    The use of keys also helps to simplify OGC API URLs for example the key ``itasca`` can be
    used in the place of a Mapfile path in a URL for example: http://localhost/mapserver/itasca/ogcapi/collections

    .. code-block:: mapfile

      MAPS
        ITASCA "/opt/mapserver/mapserver-demo/itasca.map"
        TEST_MAPFILE "/opt/mapserver/test/test.map"
      END

.. index::
   pair: CONFIG; PLUGINS
   :name: mapfile-config-plugins

PLUGINS
    This block allows for keys values to be mapped to plugin library paths. For example the :ref:`MS SQL Plugin<mssql-plugin>`.
    This registry of plugins avoids possible unsafe libraries being loaded by a Mapfile.

    .. code-block:: mapfile

      PLUGINS
        "mssql" "C:\projects\mapserver\build\Release\msplugin_mssql2008.dll"
      END

A full sample config file is shown below:

.. code-block:: mapfile

  #
  # Sample MapServer 8.0 Config File
  #
  CONFIG
  
    #
    # Environment variables
    #
    ENV
      #
      # Limit Mapfile Access
      #
      # MS_MAP_NO_PATH "1"
      MS_MAP_PATTERN "^/opt/mapserver" ## required

      #
      # Global Log/Debug Setup
      #
      # MS_DEBUGLEVEL "5"
      # MS_ERRORFILE "/opt/mapserver/logs/mapserver.log"
  
      #
      # Default Map
      #
      # MS_MAPFILE "/opt/mapserver/test/test.map"

      #
      # Other Options
      #
      # MS_ENCRYPTION_KEY
      # MS_USE_GLOBAL_FT_CACHE
      # MS_PDF_CREATION_DATE
      # MS_MAPFILE_PATTERN "\.map$"
      # MS_XMLMAPFILE_XSLT
      # MS_MODE
      # MS_OPENLAYERS_JS_URL
      # MS_TEMPPATH
      # MS_MAX_OPEN_FILES 
    END

    #
    # Map aliases
    #
    MAPS
      # TEST_MAPFILE "/opt/mapserver/test/test.map"
    END

  END

